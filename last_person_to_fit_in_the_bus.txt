Table: Queue

+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| person_id   | int     |
| person_name | varchar |
| weight      | int     |
| turn        | int     |
+-------------+---------+
person_id column contains unique values.
This table has the information about all people waiting for a bus.
The person_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.
turn determines the order of which the people will board the bus, where turn=1 denotes the first person to board and turn=n denotes the last person to board.
weight is the weight of the person in kilograms.

Query:

WITH CalcTotalWeight AS (
    SELECT
    person_name,
    weight,
    SUM(weight) OVER (ORDER BY turn) AS TotalWeight
    FROM Queue
)

SELECT person_name FROM CalcTotalWeight
WHERE TotalWeight <= 1000
ORDER BY TotalWeight DESC
LIMIT 1
